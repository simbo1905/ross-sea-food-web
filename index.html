<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Ross Sea Food Web Quiz</title>
    
    <!-- Embedded Question Sets -->
    <!-- RUST_BUNDLER_TEST_MARKER: This HTML was generated by the Rust bundle tool -->
    <script>
        window.EMBEDDED_QUESTION_SETS = {
  "questions_ross_sea_hard": {
    "metadata": {
      "description": "Test your expertise on Antarctic marine ecology with these challenging questions.",
      "mode": "hard",
      "subject": "Marine Biology",
      "targetAge": "15+ years",
      "title": "Ross Sea Food Web - Expert Challenge",
      "version": "1.0.0"
    },
    "questions": [
      {
        "category": "behavior",
        "choices": [
          "Diel vertical migration",
          "Horizontal spawning",
          "Benthic feeding",
          "Surface photosynthesis"
        ],
        "correctAnswer": 0,
        "difficulty": "hard",
        "explanation": "Krill perform diel vertical migration, moving to surface waters at night to feed and descending during the day. This behavior transports nutrients between ocean layers and affects the entire ecosystem's nutrient cycling.",
        "id": "hard_1",
        "image1": "KR.png",
        "image2": "KR.png",
        "question": "Antarctic krill (Euphausia superba) exhibit which unique behavior that affects nutrient distribution?"
      },
      {
        "category": "productivity",
        "choices": [
          "5-10%",
          "10-15%",
          "15-20%",
          "20-25%"
        ],
        "correctAnswer": 2,
        "difficulty": "hard",
        "explanation": "The Southern Ocean accounts for 15-20% of global marine primary production despite covering only 10% of ocean area. This high productivity supports the rich Antarctic food webs.",
        "id": "hard_2",
        "image1": "PP.png",
        "image2": "PP.png",
        "question": "What percentage of global marine primary production occurs in the Southern Ocean?"
      },
      {
        "category": "adaptations",
        "choices": [
          "Enlarged lungs",
          "High myoglobin in muscles",
          "Faster heartbeat",
          "Thicker blubber"
        ],
        "correctAnswer": 1,
        "difficulty": "hard",
        "explanation": "Weddell seals have extremely high myoglobin concentrations in their muscles, allowing them to store oxygen for extended dives. They also slow their heart rate and redirect blood flow to vital organs.",
        "id": "hard_3",
        "image1": "SE.png",
        "image2": "SE.png",
        "question": "Weddell seals can dive to 600m for up to 82 minutes. What physiological adaptation enables this?"
      },
      {
        "category": "adaptations",
        "choices": [
          "-0.5°C",
          "-1.0°C",
          "-1.9°C",
          "-2.5°C"
        ],
        "correctAnswer": 2,
        "difficulty": "hard",
        "explanation": "Antarctic toothfish antifreeze glycoproteins prevent ice crystal formation in their blood at -1.9°C, the freezing point of seawater. This allows them to survive in the coldest marine environment on Earth.",
        "id": "hard_4",
        "image1": "TF.png",
        "image2": "TF.png",
        "question": "The Antarctic toothfish has antifreeze proteins. At what temperature do these activate?"
      },
      {
        "category": "energy-transfer",
        "choices": [
          "5%",
          "10%",
          "20%",
          "30%"
        ],
        "correctAnswer": 1,
        "difficulty": "hard",
        "explanation": "Trophic efficiency between krill and their predators is approximately 10%, meaning 90% of energy is lost between trophic levels through respiration, movement, and waste production.",
        "id": "hard_5",
        "image1": "KR.png",
        "image2": "BW.png",
        "question": "What is the trophic efficiency between krill and their predators in the Ross Sea?"
      },
      {
        "category": "reproduction",
        "choices": [
          "30 days",
          "60 days",
          "90 days",
          "120 days"
        ],
        "correctAnswer": 3,
        "difficulty": "hard",
        "explanation": "Male emperor penguins fast for up to 120 days while incubating eggs during the Antarctic winter, losing up to 45% of their body weight. They survive on stored body fat.",
        "id": "hard_6",
        "image1": "PG.png",
        "image2": "PG.png",
        "question": "Emperor penguins can fast for up to how many days during breeding?"
      },
      {
        "category": "nutrient-cycling",
        "choices": [
          "Nitrogen fixation",
          "DOM recycling by bacteria",
          "Sulfur oxidation",
          "Methane production"
        ],
        "correctAnswer": 1,
        "difficulty": "hard",
        "explanation": "The microbial loop involves bacteria consuming dissolved organic matter (DOM) released by phytoplankton and other organisms, making nutrients available to protozoans and eventually back to larger organisms.",
        "id": "hard_7",
        "image1": "BD.png",
        "image2": "BD.png",
        "question": "The microbial loop in Antarctic waters primarily involves which process?"
      },
      {
        "category": "diet-composition",
        "choices": [
          "20-30%",
          "40-50%",
          "60-70%",
          "80-90%"
        ],
        "correctAnswer": 2,
        "difficulty": "hard",
        "explanation": "Antarctic silverfish make up 60-70% of Adélie penguin diet by mass in the Ross Sea, highlighting their critical role as a mid-trophic level species linking zooplankton to top predators.",
        "id": "hard_8",
        "image1": "SF.png",
        "image2": "PG.png",
        "question": "Antarctic silverfish comprise what percentage of Adélie penguin diet by mass?"
      },
      {
        "category": "ecosystem-processes",
        "choices": [
          "100-200m",
          "200-500m",
          "500-1000m",
          "1000-2000m"
        ],
        "correctAnswer": 1,
        "difficulty": "hard",
        "explanation": "Benthic-pelagic coupling is strongest at 200-500m depths where continental shelf productivity creates high deposition rates of organic matter, supporting rich benthic communities.",
        "id": "hard_9",
        "image1": "BI.png",
        "image2": "BI.png",
        "question": "Benthic-pelagic coupling in the Ross Sea is strongest at what depth?"
      },
      {
        "category": "hunting-behavior",
        "choices": [
          "1-5 kHz",
          "5-15 kHz",
          "15-30 kHz",
          "30-50 kHz"
        ],
        "correctAnswer": 1,
        "difficulty": "hard",
        "explanation": "Sperm whales produce clicks at 5-15 kHz for echolocation in the deep ocean. These low frequencies travel far in water and effectively detect large prey like giant squid in complete darkness.",
        "id": "hard_10",
        "image1": "TW.png",
        "image2": "SQ.png",
        "question": "Sperm whales echolocate at what frequency to hunt giant squid in darkness?"
      },
      {
        "category": "primary-production",
        "choices": [
          "50 g C/m²/yr",
          "100 g C/m²/yr",
          "200 g C/m²/yr",
          "300 g C/m²/yr"
        ],
        "correctAnswer": 2,
        "difficulty": "hard",
        "explanation": "The Ross Sea polynya has exceptional primary productivity at ~200 g C/m²/yr, making it one of the most productive areas in the Southern Ocean due to extended ice-free conditions and nutrient upwelling.",
        "id": "hard_11",
        "image1": "PP.png",
        "image2": "PP.png",
        "question": "The Ross Sea polynya's annual primary production is approximately:"
      },
      {
        "category": "conservation",
        "choices": [
          "30%",
          "40%",
          "50%",
          "60%"
        ],
        "correctAnswer": 2,
        "difficulty": "hard",
        "explanation": "CCAMLR (Commission for Conservation of Antarctic Marine Living Resources) manages toothfish fisheries to maintain at least 50% of spawning stock biomass, using a precautionary approach to ensure sustainability.",
        "id": "hard_12",
        "image1": "FH.png",
        "image2": "TF.png",
        "question": "CCAMLR fishing regulations limit toothfish catch to maintain what percentage of spawning biomass?"
      },
      {
        "category": "life-cycle",
        "choices": [
          "50-100 m/day",
          "100-150 m/day",
          "150-200 m/day",
          "200-250 m/day"
        ],
        "correctAnswer": 1,
        "difficulty": "hard",
        "explanation": "Krill eggs sink at 100-150 m/day, descending to 700-1000m before hatching. The nauplii then swim upward over several weeks, a strategy that may reduce predation during vulnerable early stages.",
        "id": "hard_13",
        "image1": "KR.png",
        "image2": "KR.png",
        "question": "Antarctic krill eggs sink at what rate before hatching nauplii ascend?"
      },
      {
        "category": "climate-change",
        "choices": [
          "5 days earlier per decade",
          "10 days earlier per decade",
          "15 days earlier per decade",
          "20 days earlier per decade"
        ],
        "correctAnswer": 1,
        "difficulty": "hard",
        "explanation": "Satellite data shows Ross Sea phytoplankton blooms are occurring ~10 days earlier per decade due to earlier sea ice retreat, potentially creating mismatches with krill reproduction and grazer life cycles.",
        "id": "hard_14",
        "image1": "PP.png",
        "image2": "PP.png",
        "question": "Climate change is causing Ross Sea phytoplankton blooms to shift by approximately:"
      },
      {
        "category": "biomass",
        "choices": [
          "100-200 million tonnes",
          "300-500 million tonnes",
          "600-800 million tonnes",
          "900-1100 million tonnes"
        ],
        "correctAnswer": 1,
        "difficulty": "hard",
        "explanation": "Recent acoustic surveys estimate Antarctic krill biomass at 300-500 million tonnes, making it one of the most abundant species on Earth by total biomass, though estimates vary significantly by region and method.",
        "id": "hard_15",
        "image1": "KR.png",
        "image2": "KR.png",
        "question": "The biomass of Antarctic krill in the Southern Ocean is estimated at:"
      }
    ]
  },
  "questions_ross_sea_easy": {
    "metadata": {
      "description": "Learn about who eats who in the Ross Sea! Perfect for young marine biologists.",
      "mode": "easy",
      "subject": "Marine Biology",
      "targetAge": "5-8 years",
      "title": "Ross Sea Food Web - Little Explorers",
      "version": "1.0.0"
    },
    "questions": [
      {
        "category": "food-chain",
        "choices": [
          "Penguins",
          "Bacteria",
          "Phytoplankton",
          "Toothfish"
        ],
        "correctAnswer": 0,
        "difficulty": "easy",
        "explanation": "Penguins love to eat krill! Krill are tiny shrimp-like creatures that swim in large groups called swarms. Penguins can eat hundreds of krill in one day!",
        "id": "kids_1",
        "image1": "KR.png",
        "image2": "PG.png",
        "question": "The animal above is eaten by which animal below?"
      },
      {
        "category": "food-chain",
        "choices": [
          "Bacteria",
          "Fish",
          "Phytoplankton",
          "Birds"
        ],
        "correctAnswer": 1,
        "difficulty": "easy",
        "explanation": "Seals are excellent hunters that catch and eat fish! They have sharp teeth and can swim very fast underwater to catch their prey.",
        "id": "kids_2",
        "image1": "SE.png",
        "image2": "FI.png",
        "question": "What does this animal eat?"
      },
      {
        "category": "food-chain",
        "choices": [
          "Seals",
          "Penguins",
          "Krill",
          "Toothfish"
        ],
        "correctAnswer": 2,
        "difficulty": "easy",
        "explanation": "Krill eat phytoplankton! Phytoplankton are tiny plants that float in the water and make their own food using sunlight, just like plants on land!",
        "id": "kids_3",
        "image1": "PP.png",
        "image2": "KR.png",
        "question": "The tiny plants above are food for which animal?"
      },
      {
        "category": "food-chain",
        "choices": [
          "Phytoplankton",
          "Bacteria",
          "Krill",
          "Penguins"
        ],
        "correctAnswer": 3,
        "difficulty": "easy",
        "explanation": "Penguins catch and eat silverfish! These little fish are one of the penguin's favorite foods in the cold waters of Antarctica.",
        "id": "kids_4",
        "image1": "SF.png",
        "image2": "PG.png",
        "question": "Which animal eats the fish shown above?"
      },
      {
        "category": "food-chain",
        "choices": [
          "Krill",
          "Seals",
          "Penguins",
          "Large fish"
        ],
        "correctAnswer": 0,
        "difficulty": "easy",
        "explanation": "Baleen whales eat krill! Even though these whales are huge, they eat tiny krill by filtering them through special plates in their mouths called baleen.",
        "id": "kids_5",
        "image1": "BW.png",
        "image2": "KR.png",
        "question": "What do these giant whales eat?"
      },
      {
        "category": "food-chain",
        "choices": [
          "Krill",
          "Phytoplankton",
          "Toothed whales",
          "Bacteria"
        ],
        "correctAnswer": 2,
        "difficulty": "easy",
        "explanation": "Toothed whales like sperm whales hunt and eat squid! They dive very deep in the ocean to catch them.",
        "id": "kids_6",
        "image1": "SQ.png",
        "image2": "TW.png",
        "question": "The squid above is food for which predator?"
      },
      {
        "category": "food-chain",
        "choices": [
          "Seals",
          "Penguins",
          "Baleen whales",
          "Toothed whales"
        ],
        "correctAnswer": 2,
        "difficulty": "easy",
        "explanation": "Baleen whales don't eat regular fish! They have special filters called baleen plates that catch tiny creatures like krill and small silverfish, but not larger fish.",
        "id": "kids_7",
        "image1": "FI.png",
        "image2": "BW.png",
        "question": "Which large predator does NOT eat this prey?"
      },
      {
        "category": "human-impact",
        "choices": [
          "Krill",
          "Penguins",
          "Toothfish",
          "Whales"
        ],
        "correctAnswer": 2,
        "difficulty": "easy",
        "explanation": "Fishing boats catch toothfish in the Ross Sea. These large fish are sold for food, but we must be careful not to catch too many!",
        "id": "kids_8",
        "image1": "FH.png",
        "image2": "TF.png",
        "question": "What do the boats above catch from the Ross Sea?"
      },
      {
        "category": "food-chain",
        "choices": [
          "Krill",
          "Bacteria",
          "Fish",
          "Phytoplankton"
        ],
        "correctAnswer": 2,
        "difficulty": "easy",
        "explanation": "Benthic invertebrates (creatures that live on the ocean floor) are eaten by fish! The fish swim down to hunt for worms, sea stars, and other tasty bottom-dwellers.",
        "id": "kids_9",
        "image1": "BI.png",
        "image2": "FI.png",
        "question": "What do bottom-dwelling creatures become food for?"
      },
      {
        "category": "food-chain",
        "choices": [
          "Bacteria",
          "Large fish",
          "Zooplankton",
          "Seals"
        ],
        "correctAnswer": 2,
        "difficulty": "easy",
        "explanation": "Silverfish eat zooplankton! These are tiny floating animals that drift in the water. Silverfish swim through the water with their mouths open to catch them.",
        "id": "kids_10",
        "image1": "ZP.png",
        "image2": "SF.png",
        "question": "Which tiny creatures are eaten by silverfish?"
      }
    ]
  },
  "questions_ross_sea_medium": {
    "metadata": {
      "description": "Explore the Ross Sea ecosystem with challenging questions about Antarctic marine life.",
      "mode": "easy",
      "subject": "Marine Biology",
      "targetAge": "9-14 years",
      "title": "Ross Sea Food Web - Ocean Adventurers",
      "version": "1.0.0"
    },
    "questions": [
      {
        "category": "ecosystem",
        "choices": [
          "Fish",
          "Krill",
          "Seals",
          "Whales"
        ],
        "correctAnswer": 1,
        "difficulty": "medium",
        "explanation": "Krill form enormous swarms and represent the largest biomass in Antarctic waters. A single swarm can contain millions of individuals and stretch for kilometers!",
        "id": "med_1",
        "image1": "KR.png",
        "image2": "KR.png",
        "question": "Which animals form the largest biomass in the Ross Sea food web?"
      },
      {
        "category": "predator-prey",
        "choices": [
          "Krill",
          "Phytoplankton",
          "Giant squid",
          "Small fish"
        ],
        "correctAnswer": 2,
        "difficulty": "medium",
        "explanation": "Sperm whales and other toothed whales dive deep to hunt giant squid. Some battles between sperm whales and giant squid leave scars on the whale's skin!",
        "id": "med_2",
        "image1": "TW.png",
        "image2": "SQ.png",
        "question": "The whale above has teeth. What is its main prey?"
      },
      {
        "category": "energy-flow",
        "choices": [
          "They eat other organisms",
          "They produce their own food from sunlight",
          "They produce oxygen only",
          "They reproduce quickly"
        ],
        "correctAnswer": 1,
        "difficulty": "medium",
        "explanation": "Phytoplankton are primary producers because they convert sunlight into food through photosynthesis, forming the base of the ocean food web.",
        "id": "med_3",
        "image1": "PP.png",
        "image2": "PP.png",
        "question": "Why are phytoplankton called 'primary producers'?"
      },
      {
        "category": "adaptations",
        "choices": [
          "They hunt larger prey",
          "They filter small organisms from water",
          "They eat only plants",
          "They feed at night"
        ],
        "correctAnswer": 1,
        "difficulty": "medium",
        "explanation": "Baleen whales have comb-like plates that filter huge amounts of water to catch tiny organisms like krill, while toothed whales hunt individual larger prey.",
        "id": "med_4",
        "image1": "BW.png",
        "image2": "KR.png",
        "question": "How do baleen whales feed differently from toothed whales?"
      },
      {
        "category": "nutrient-cycling",
        "choices": [
          "Primary producers",
          "Top predators",
          "Decomposers",
          "Primary consumers"
        ],
        "correctAnswer": 2,
        "difficulty": "medium",
        "explanation": "Bacteria are decomposers that break down dead organisms and waste, recycling nutrients back into the ecosystem for primary producers to use.",
        "id": "med_5",
        "image1": "BD.png",
        "image2": "BD.png",
        "question": "What role do these organisms play in the ecosystem?"
      },
      {
        "category": "predator-prey",
        "choices": [
          "Seals",
          "Skua birds",
          "Whales",
          "Fish"
        ],
        "correctAnswer": 1,
        "difficulty": "medium",
        "explanation": "Skuas are aggressive seabirds that prey on penguin eggs and chicks. They're opportunistic feeders and play an important role in the Antarctic ecosystem.",
        "id": "med_6",
        "image1": "FB.png",
        "image2": "FB.png",
        "question": "Which predator is known for stealing penguin eggs and chicks?"
      },
      {
        "category": "human-impact",
        "choices": [
          "They eat too much krill",
          "They're primary producers",
          "They're top predators that control fish populations",
          "They produce oxygen"
        ],
        "correctAnswer": 2,
        "difficulty": "medium",
        "explanation": "Toothfish are apex predators. Removing too many disrupts the balance by allowing their prey species to multiply unchecked, affecting the entire food web.",
        "id": "med_7",
        "image1": "TF.png",
        "image2": "FH.png",
        "question": "Why is overfishing of toothfish a concern for the Ross Sea ecosystem?"
      },
      {
        "category": "food-web",
        "choices": [
          "Temperature",
          "Krill as a key food source",
          "Ocean depth",
          "Migration patterns"
        ],
        "correctAnswer": 1,
        "difficulty": "medium",
        "explanation": "Krill are the keystone species connecting primary producers to higher predators. Most Antarctic animals either eat krill directly or eat animals that feed on krill.",
        "id": "med_8",
        "image1": "KR.png",
        "image2": "KR.png",
        "question": "What connects all organisms in this Antarctic food web?"
      },
      {
        "category": "energy-flow",
        "choices": [
          "Live fish",
          "Sunlight",
          "Marine snow (dead organic matter)",
          "Large whales"
        ],
        "correctAnswer": 2,
        "difficulty": "medium",
        "explanation": "Benthic invertebrates feed on 'marine snow' - dead plankton, feces, and other organic matter that slowly sinks to the ocean floor from the waters above.",
        "id": "med_9",
        "image1": "BI.png",
        "image2": "BI.png",
        "question": "These bottom-dwelling creatures feed on what?"
      },
      {
        "category": "adaptations",
        "choices": [
          "Penguins",
          "Krill",
          "Elephant seals",
          "Silverfish"
        ],
        "correctAnswer": 2,
        "difficulty": "medium",
        "explanation": "Elephant seals can dive over 2,000 meters deep and hold their breath for up to 2 hours while hunting for deep-sea fish and squid!",
        "id": "med_10",
        "image1": "SE.png",
        "image2": "FI.png",
        "question": "Which animal above can dive deepest in search of food?"
      },
      {
        "category": "seasonal-changes",
        "choices": [
          "They increase",
          "They decrease due to less sunlight",
          "They stay the same",
          "They move deeper"
        ],
        "correctAnswer": 1,
        "difficulty": "medium",
        "explanation": "Phytoplankton populations crash in winter when there's no sunlight for photosynthesis during the polar night, affecting the entire food web.",
        "id": "med_11",
        "image1": "PP.png",
        "image2": "PP.png",
        "question": "In winter, what happens to phytoplankton populations?"
      },
      {
        "category": "predator-prey",
        "choices": [
          "None - they're herbivores",
          "1-2 penguins",
          "5-6 penguins",
          "10+ penguins"
        ],
        "correctAnswer": 1,
        "difficulty": "medium",
        "explanation": "Leopard seals are fierce predators that typically catch 1-2 penguins per day. They wait near ice edges where penguins enter and exit the water.",
        "id": "med_12",
        "image1": "SE.png",
        "image2": "PG.png",
        "question": "How many penguins can a leopard seal eat in one day?"
      }
    ]
  }
};
        // Backwards compatibility 
        window.EMBEDDED_GAME_DATA = {
  "metadata": {
    "description": "Test your expertise on Antarctic marine ecology with these challenging questions.",
    "mode": "hard",
    "subject": "Marine Biology",
    "targetAge": "15+ years",
    "title": "Ross Sea Food Web - Expert Challenge",
    "version": "1.0.0"
  },
  "questions": [
    {
      "category": "behavior",
      "choices": [
        "Diel vertical migration",
        "Horizontal spawning",
        "Benthic feeding",
        "Surface photosynthesis"
      ],
      "correctAnswer": 0,
      "difficulty": "hard",
      "explanation": "Krill perform diel vertical migration, moving to surface waters at night to feed and descending during the day. This behavior transports nutrients between ocean layers and affects the entire ecosystem's nutrient cycling.",
      "id": "hard_1",
      "image1": "KR.png",
      "image2": "KR.png",
      "question": "Antarctic krill (Euphausia superba) exhibit which unique behavior that affects nutrient distribution?"
    },
    {
      "category": "productivity",
      "choices": [
        "5-10%",
        "10-15%",
        "15-20%",
        "20-25%"
      ],
      "correctAnswer": 2,
      "difficulty": "hard",
      "explanation": "The Southern Ocean accounts for 15-20% of global marine primary production despite covering only 10% of ocean area. This high productivity supports the rich Antarctic food webs.",
      "id": "hard_2",
      "image1": "PP.png",
      "image2": "PP.png",
      "question": "What percentage of global marine primary production occurs in the Southern Ocean?"
    },
    {
      "category": "adaptations",
      "choices": [
        "Enlarged lungs",
        "High myoglobin in muscles",
        "Faster heartbeat",
        "Thicker blubber"
      ],
      "correctAnswer": 1,
      "difficulty": "hard",
      "explanation": "Weddell seals have extremely high myoglobin concentrations in their muscles, allowing them to store oxygen for extended dives. They also slow their heart rate and redirect blood flow to vital organs.",
      "id": "hard_3",
      "image1": "SE.png",
      "image2": "SE.png",
      "question": "Weddell seals can dive to 600m for up to 82 minutes. What physiological adaptation enables this?"
    },
    {
      "category": "adaptations",
      "choices": [
        "-0.5°C",
        "-1.0°C",
        "-1.9°C",
        "-2.5°C"
      ],
      "correctAnswer": 2,
      "difficulty": "hard",
      "explanation": "Antarctic toothfish antifreeze glycoproteins prevent ice crystal formation in their blood at -1.9°C, the freezing point of seawater. This allows them to survive in the coldest marine environment on Earth.",
      "id": "hard_4",
      "image1": "TF.png",
      "image2": "TF.png",
      "question": "The Antarctic toothfish has antifreeze proteins. At what temperature do these activate?"
    },
    {
      "category": "energy-transfer",
      "choices": [
        "5%",
        "10%",
        "20%",
        "30%"
      ],
      "correctAnswer": 1,
      "difficulty": "hard",
      "explanation": "Trophic efficiency between krill and their predators is approximately 10%, meaning 90% of energy is lost between trophic levels through respiration, movement, and waste production.",
      "id": "hard_5",
      "image1": "KR.png",
      "image2": "BW.png",
      "question": "What is the trophic efficiency between krill and their predators in the Ross Sea?"
    },
    {
      "category": "reproduction",
      "choices": [
        "30 days",
        "60 days",
        "90 days",
        "120 days"
      ],
      "correctAnswer": 3,
      "difficulty": "hard",
      "explanation": "Male emperor penguins fast for up to 120 days while incubating eggs during the Antarctic winter, losing up to 45% of their body weight. They survive on stored body fat.",
      "id": "hard_6",
      "image1": "PG.png",
      "image2": "PG.png",
      "question": "Emperor penguins can fast for up to how many days during breeding?"
    },
    {
      "category": "nutrient-cycling",
      "choices": [
        "Nitrogen fixation",
        "DOM recycling by bacteria",
        "Sulfur oxidation",
        "Methane production"
      ],
      "correctAnswer": 1,
      "difficulty": "hard",
      "explanation": "The microbial loop involves bacteria consuming dissolved organic matter (DOM) released by phytoplankton and other organisms, making nutrients available to protozoans and eventually back to larger organisms.",
      "id": "hard_7",
      "image1": "BD.png",
      "image2": "BD.png",
      "question": "The microbial loop in Antarctic waters primarily involves which process?"
    },
    {
      "category": "diet-composition",
      "choices": [
        "20-30%",
        "40-50%",
        "60-70%",
        "80-90%"
      ],
      "correctAnswer": 2,
      "difficulty": "hard",
      "explanation": "Antarctic silverfish make up 60-70% of Adélie penguin diet by mass in the Ross Sea, highlighting their critical role as a mid-trophic level species linking zooplankton to top predators.",
      "id": "hard_8",
      "image1": "SF.png",
      "image2": "PG.png",
      "question": "Antarctic silverfish comprise what percentage of Adélie penguin diet by mass?"
    },
    {
      "category": "ecosystem-processes",
      "choices": [
        "100-200m",
        "200-500m",
        "500-1000m",
        "1000-2000m"
      ],
      "correctAnswer": 1,
      "difficulty": "hard",
      "explanation": "Benthic-pelagic coupling is strongest at 200-500m depths where continental shelf productivity creates high deposition rates of organic matter, supporting rich benthic communities.",
      "id": "hard_9",
      "image1": "BI.png",
      "image2": "BI.png",
      "question": "Benthic-pelagic coupling in the Ross Sea is strongest at what depth?"
    },
    {
      "category": "hunting-behavior",
      "choices": [
        "1-5 kHz",
        "5-15 kHz",
        "15-30 kHz",
        "30-50 kHz"
      ],
      "correctAnswer": 1,
      "difficulty": "hard",
      "explanation": "Sperm whales produce clicks at 5-15 kHz for echolocation in the deep ocean. These low frequencies travel far in water and effectively detect large prey like giant squid in complete darkness.",
      "id": "hard_10",
      "image1": "TW.png",
      "image2": "SQ.png",
      "question": "Sperm whales echolocate at what frequency to hunt giant squid in darkness?"
    },
    {
      "category": "primary-production",
      "choices": [
        "50 g C/m²/yr",
        "100 g C/m²/yr",
        "200 g C/m²/yr",
        "300 g C/m²/yr"
      ],
      "correctAnswer": 2,
      "difficulty": "hard",
      "explanation": "The Ross Sea polynya has exceptional primary productivity at ~200 g C/m²/yr, making it one of the most productive areas in the Southern Ocean due to extended ice-free conditions and nutrient upwelling.",
      "id": "hard_11",
      "image1": "PP.png",
      "image2": "PP.png",
      "question": "The Ross Sea polynya's annual primary production is approximately:"
    },
    {
      "category": "conservation",
      "choices": [
        "30%",
        "40%",
        "50%",
        "60%"
      ],
      "correctAnswer": 2,
      "difficulty": "hard",
      "explanation": "CCAMLR (Commission for Conservation of Antarctic Marine Living Resources) manages toothfish fisheries to maintain at least 50% of spawning stock biomass, using a precautionary approach to ensure sustainability.",
      "id": "hard_12",
      "image1": "FH.png",
      "image2": "TF.png",
      "question": "CCAMLR fishing regulations limit toothfish catch to maintain what percentage of spawning biomass?"
    },
    {
      "category": "life-cycle",
      "choices": [
        "50-100 m/day",
        "100-150 m/day",
        "150-200 m/day",
        "200-250 m/day"
      ],
      "correctAnswer": 1,
      "difficulty": "hard",
      "explanation": "Krill eggs sink at 100-150 m/day, descending to 700-1000m before hatching. The nauplii then swim upward over several weeks, a strategy that may reduce predation during vulnerable early stages.",
      "id": "hard_13",
      "image1": "KR.png",
      "image2": "KR.png",
      "question": "Antarctic krill eggs sink at what rate before hatching nauplii ascend?"
    },
    {
      "category": "climate-change",
      "choices": [
        "5 days earlier per decade",
        "10 days earlier per decade",
        "15 days earlier per decade",
        "20 days earlier per decade"
      ],
      "correctAnswer": 1,
      "difficulty": "hard",
      "explanation": "Satellite data shows Ross Sea phytoplankton blooms are occurring ~10 days earlier per decade due to earlier sea ice retreat, potentially creating mismatches with krill reproduction and grazer life cycles.",
      "id": "hard_14",
      "image1": "PP.png",
      "image2": "PP.png",
      "question": "Climate change is causing Ross Sea phytoplankton blooms to shift by approximately:"
    },
    {
      "category": "biomass",
      "choices": [
        "100-200 million tonnes",
        "300-500 million tonnes",
        "600-800 million tonnes",
        "900-1100 million tonnes"
      ],
      "correctAnswer": 1,
      "difficulty": "hard",
      "explanation": "Recent acoustic surveys estimate Antarctic krill biomass at 300-500 million tonnes, making it one of the most abundant species on Earth by total biomass, though estimates vary significantly by region and method.",
      "id": "hard_15",
      "image1": "KR.png",
      "image2": "KR.png",
      "question": "The biomass of Antarctic krill in the Southern Ocean is estimated at:"
    }
  ]
};
        
        // Build information
        window.BUILD_INFO = {
            timestamp: "2025-08-29T17:46:08.988285+01:00",
            timestampUnix: 1756485968,
            version: "git-5d2b023"
        };
        
        // Debug logging
        console.log("🏗️ Build info:", window.BUILD_INFO);
        console.log("🚀 Page loaded and ready.");
    </script>
    
    <!-- Embedded CSS -->
    <style>
        /* Modern CSS Reset and Base Styles */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    line-height: 1.6;
    color: #333;
    background: linear-gradient(135deg, #0288d1 0%, #01579b 50%, #e0f7fa 100%);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
}

#game-container {
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}

/* Screen Management */
.screen {
    background: white;
    border-radius: 16px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    padding: 40px;
    text-align: center;
    min-height: 500px;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

/* Loading Screen */
.loading-content h1 {
    color: #4a5568;
    margin-bottom: 30px;
    font-size: 2.5rem;
}

.spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #e2e8f0;
    border-top: 4px solid #0288d1;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 20px auto;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Start Screen */
.start-content h1 {
    color: #2d3748;
    margin-bottom: 20px;
    font-size: 2.5rem;
}

.start-content p {
    font-size: 1.2rem;
    color: #4a5568;
    margin-bottom: 30px;
}

/* Question Set Selector */
.question-set-selector-container {
    background: #f7fafc;
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0 30px 0;
    text-align: left;
}

.question-set-selector-container label {
    display: block;
    font-weight: 600;
    color: #4a5568;
    margin-bottom: 10px;
    font-size: 1.1rem;
}

.question-set-selector {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    background: white;
    font-size: 1rem;
    color: #2d3748;
    cursor: pointer;
    transition: all 0.3s ease;
}

.question-set-selector:hover {
    border-color: #0288d1;
}

.question-set-selector:focus {
    outline: none;
    border-color: #0288d1;
    box-shadow: 0 0 0 3px rgba(2, 136, 209, 0.1);
}

/* Game Screen */
.game-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding: 20px;
    background: #f7fafc;
    border-radius: 12px;
}

.counter, .score {
    font-weight: 600;
    font-size: 1.1rem;
    color: #4a5568;
}

.question-container {
    text-align: center;
}

.question {
    font-size: 1.8rem;
    color: #2d3748;
    margin-bottom: 40px;
    line-height: 1.4;
}

.choices {
    display: grid;
    gap: 15px;
    max-width: 600px;
    margin: 0 auto;
}

.choice-button {
    background: #f7fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    padding: 20px;
    font-size: 1.1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: left;
}

.choice-button:hover:not(:disabled) {
    background: #e3f2fd;
    border-color: #0288d1;
    transform: translateY(-2px);
}

.choice-button:disabled {
    cursor: not-allowed;
}

.choice-button.correct {
    background: #c6f6d5;
    border-color: #38a169;
    color: #22543d;
}

.choice-button.incorrect {
    background: #fed7d7;
    border-color: #e53e3e;
    color: #742a2a;
}

/* Result Screen */
.result-content {
    text-align: center;
}

.result-icon {
    font-size: 4rem;
    margin-bottom: 20px;
}

.result-text {
    font-size: 2rem;
    margin-bottom: 30px;
    color: #2d3748;
}

.explanation-container {
    background: #f7fafc;
    border-radius: 12px;
    padding: 30px;
    margin: 30px 0;
    text-align: left;
}

.explanation-container h3 {
    color: #4a5568;
    margin-bottom: 15px;
    font-size: 1.3rem;
}

.explanation {
    font-size: 1.1rem;
    line-height: 1.7;
    color: #2d3748;
}

/* Finish Screen */
.finish-content h1 {
    color: #2d3748;
    margin-bottom: 40px;
    font-size: 2.5rem;
}

.final-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
    margin: 40px 0;
}

.stat-item {
    background: #f7fafc;
    border-radius: 12px;
    padding: 30px;
}

.stat-item h2 {
    color: #4a5568;
    margin-bottom: 15px;
    font-size: 1.3rem;
}

.big-number {
    font-size: 2.5rem;
    font-weight: 700;
    color: #0288d1;
}

.finish-message {
    margin: 30px 0;
}

.finish-message p {
    font-size: 1.2rem;
    color: #4a5568;
    font-style: italic;
}

.attribution-message {
    margin-top: 20px;
    font-style: normal !important;
    line-height: 1.6;
}

.visit-link {
    color: #0288d1;
    text-decoration: none;
    font-weight: 600;
    display: inline-block;
    margin-top: 10px;
    transition: all 0.3s ease;
}

.visit-link:hover {
    color: #01579b;
    text-decoration: underline;
    transform: translateX(5px);
}

/* Buttons */
.primary-button {
    background: #0288d1;
    color: white;
    border: none;
    border-radius: 12px;
    padding: 15px 30px;
    font-size: 1.2rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 20px;
}

.primary-button:hover {
    background: #01579b;
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(2, 136, 209, 0.3);
}

.primary-button:active {
    transform: translateY(0);
}

/* Error Styling */
.error {
    text-align: center;
    color: #e53e3e;
}

.error h2 {
    margin-bottom: 20px;
}

.error button {
    background: #e53e3e;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 12px 24px;
    cursor: pointer;
    margin-top: 20px;
}

/* Build Info Footer */
.build-info {
    display: none; /* Hide build info on production */
}

/* Copyright Footer */
.copyright-footer {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.95);
    padding: 3px 10px;
    text-align: center;
    font-size: 9px;
    color: #666;
    z-index: 999;
    line-height: 1.2;
    border-top: 1px solid #e0e0e0;
    box-shadow: 0 -2px 4px rgba(0,0,0,0.1);
}

.copyright-footer small {
    display: block;
}

.copyright-footer a {
    color: #0288d1;
    text-decoration: none;
}

.copyright-footer a:hover {
    text-decoration: underline;
}

/* Mobile-specific copyright adjustments */
@media (max-width: 768px) {
    .copyright-footer {
        font-size: 8px;
        padding: 2px 5px;
        line-height: 1.1;
    }
    
    /* Hide longer text on mobile, show abbreviated version */
    .copyright-footer br {
        display: none;
    }
    
    #game-container {
        padding-bottom: 30px; /* Add space for fixed footer */
    }
}

/* Question Set Tiles */
.question-set-tiles-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 30px;
    width: 100%;
}

.question-set-tile {
    background: #f7fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    min-height: 120px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.question-set-tile:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.05);
    border-color: #0288d1;
}

.tile-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: #2d3748;
    transition: opacity 0.3s ease;
}

.tile-description {
    display: none; /* Hide descriptions inside tiles - they'll show below instead */
}

.question-set-tile:hover .tile-title {
    /* Keep title visible on hover - no text changes in tiles */
}

/* Fixed height for description to prevent tile jiggling */
#game-description {
    min-height: 4.2em; /* Reserve space for up to 3 lines of text */
    line-height: 1.4;
    margin-top: 20px;
    padding: 10px 0;
    text-align: center;
    color: #666;
    overflow: hidden; /* Prevent text from extending beyond reserved space */
}

/* Game Info (removed from original design) */
.game-info {
    display: none;
}

/* Start button (removed from original design) */
#start-button {
    display: none;
}

/* Image Styles */
.question-image,
.answer-image {
    max-width: 300px;
    max-height: 200px;
    width: auto;
    height: auto;
    margin: 20px auto;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    display: block;
}

.question-image {
    margin-bottom: 20px;
}

.answer-image {
    margin: 20px auto;
}

/* Responsive Design */
@media (max-width: 768px) {
    #game-container {
        padding: 10px;
    }
    
    .screen {
        padding: 20px;
        margin: 10px;
    }
    
    .question {
        font-size: 1.5rem;
    }
    
    .choice-button {
        padding: 15px;
        font-size: 1rem;
    }
    
    .final-stats {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .game-header {
        flex-direction: column;
        gap: 10px;
        text-align: center;
    }
}

@media (max-width: 480px) {
    .start-content h1,
    .finish-content h1 {
        font-size: 2rem;
    }
    
    .question {
        font-size: 1.3rem;
    }
    
    .big-number {
        font-size: 2rem;
    }
}
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Loading Screen -->
        <div class="screen" id="loading-screen">
            <div class="loading-content">
                <h1>🐧 Ross Sea Food Web Quiz</h1>
                <div class="spinner"></div>
                <p>Loading questions...</p>
            </div>
        </div>
        
        <!-- Start Screen -->
        <div class="screen" id="start-screen" style="display: none;">
            <div class="start-content">
                <h1 id="game-title">🌊 Ross Sea Food Web Quiz 🐧</h1>
                
                <!-- Question Set Tiles -->
                <div id="question-set-tiles" class="question-set-tiles-container">
                    <!-- Tiles will be dynamically inserted here -->
                </div>
                
                <!-- Description appears below tiles and changes on hover -->
                <p id="game-description">Explore the Antarctic marine ecosystem and learn about predator-prey relationships!</p>
            </div>
        </div>
        
        <!-- Game Screen -->
        <div class="screen" id="game-screen" style="display: none;">
            <div class="game-header">
                <div class="counter" id="question-counter">Question 1 of 6</div>
                <div class="score" id="score-display">Score: 0/0</div>
            </div>
            <div class="question-container">
                <img id="question-image" class="question-image" style="display: none;" alt="Question image">
                <h2 class="question" id="question-text">Loading question...</h2>
                <div class="choices" id="choices-container">
                    <!-- Choice buttons will be inserted here -->
                </div>
            </div>
        </div>
        
        <!-- Result Screen -->
        <div class="screen" id="result-screen" style="display: none;">
            <div class="result-content">
                <div class="result-icon" id="result-icon">✅</div>
                <h2 class="result-text" id="result-text">Correct!</h2>
                <img id="answer-image" class="answer-image" style="display: none;" alt="Answer image">
                <div class="explanation-container">
                    <h3>Learn More:</h3>
                    <p class="explanation" id="explanation-text">Explanation will appear here...</p>
                </div>
                <button class="primary-button" id="next-button">Next Question</button>
            </div>
        </div>
        
        <!-- Finish Screen -->
        <div class="screen" id="finish-screen" style="display: none;">
            <div class="finish-content">
                <h1>🎉 Well Done!</h1>
                <div class="final-stats">
                    <div class="stat-item">
                        <h2>Final Score</h2>
                        <div class="big-number" id="final-score">0 out of 6</div>
                    </div>
                    <div class="stat-item">
                        <h2>Accuracy</h2>
                        <div class="big-number" id="final-percentage">0%</div>
                    </div>
                </div>
                <div class="finish-message">
                    <p>Great job learning about the Ross Sea food web!</p>
                    <p class="attribution-message">
                        Thank you to Science Learning Hub NZ and The University of Waikato 
                        for providing this excellent educational content!<br>
                        <a href="https://www.sciencelearn.org.nz" target="_blank" class="visit-link">
                            Visit Science Learning Hub for more fascinating science resources →
                        </a>
                    </p>
                </div>
                <button class="primary-button" id="play-again-button">Play Again</button>
            </div>
        </div>
    </div>
    
    <!-- Build info footer -->
    <div class="build-info">
        <small>vgit-5d2b023 • Built: 2025-08-29T17:46:08.988285+01:00</small>
    </div>
    
    <!-- Copyright Attribution -->
    <div class="copyright-footer">
        <small>
            © University of Waikato | <a href="https://www.sciencelearn.org.nz" target="_blank">sciencelearn.org.nz</a> | Based on M. Pinkerton/NIWA diagram
        </small>
    </div>
    
    <!-- Embedded JavaScript -->
    <script>
        /**
 * Just The Game Engine
 * Core logic for flash-card quiz game
 */

class GameEngine {
    constructor() {
        this.questions = [];
        this.currentQuestionIndex = 0;
        this.score = 0;
        this.answered = 0;
        this.gameState = 'loading'; // loading, ready, playing, question-answered, finished
        this.currentQuestion = null;
        this.userAnswer = null;
        this.gameData = null;
    }

    /**
     * Load questions from JSON data
     * @param {Object} gameData - The complete game data object
     */
    async loadQuestions(gameData) {
        try {
            this.gameData = gameData;
            this.questions = gameData.questions || [];
            this.shuffleQuestions();
            this.currentQuestionIndex = 0;
            this.score = 0;
            this.answered = 0;
            this.gameState = 'ready';
            this.currentQuestion = null;
            this.userAnswer = null;
            
            console.log(`Loaded ${this.questions.length} questions`);
            return true;
        } catch (error) {
            console.error('Error loading questions:', error);
            this.gameState = 'error';
            return false;
        }
    }

    /**
     * Shuffle questions for random order
     */
    shuffleQuestions() {
        for (let i = this.questions.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [this.questions[i], this.questions[j]] = [this.questions[j], this.questions[i]];
        }
    }

    /**
     * Start the game
     */
    startGame() {
        if (this.gameState !== 'ready') {
            throw new Error('Game not ready to start');
        }
        
        this.currentQuestionIndex = 0;
        this.score = 0;
        this.answered = 0;
        this.gameState = 'playing';
        this.loadCurrentQuestion();
    }

    /**
     * Load the current question
     */
    loadCurrentQuestion() {
        if (this.currentQuestionIndex >= this.questions.length) {
            this.gameState = 'finished';
            return null;
        }

        this.currentQuestion = this.questions[this.currentQuestionIndex];
        this.userAnswer = null;
        this.gameState = 'playing';
        console.log(`🎯 DEBUG: Question ${this.currentQuestionIndex + 1} correct answer is index ${this.currentQuestion.correctAnswer}`);
        return this.currentQuestion;
    }

    /**
     * Submit an answer for the current question
     * @param {number} answerIndex - Index of the selected answer
     */
    submitAnswer(answerIndex) {
        if (this.gameState !== 'playing' || !this.currentQuestion) {
            throw new Error('No active question to answer');
        }

        if (answerIndex < 0 || answerIndex >= this.currentQuestion.choices.length) {
            throw new Error('Invalid answer index');
        }

        this.userAnswer = answerIndex;
        const isCorrect = answerIndex === this.currentQuestion.correctAnswer;
        const mode = this.getMetadata().mode || 'hard';

        // In easy mode, if the answer is incorrect, we don't advance the game state.
        // We just provide feedback that the answer was wrong.
        if (mode === 'easy' && !isCorrect) {
            return {
                correct: false,
                correctAnswerIndex: this.currentQuestion.correctAnswer,
                userAnswerText: this.currentQuestion.choices[answerIndex],
                explanation: 'That wasn\'t correct. Try another answer!',
                mode: 'easy'
            };
        }
        
        this.answered++;
        
        if (isCorrect) {
            this.score++;
        }

        this.gameState = 'question-answered';
        
        return {
            correct: isCorrect,
            correctAnswerIndex: this.currentQuestion.correctAnswer,
            correctAnswerText: this.currentQuestion.choices[this.currentQuestion.correctAnswer],
            userAnswerText: this.currentQuestion.choices[answerIndex],
            explanation: this.currentQuestion.explanation,
            mode: mode
        };
    }

    /**
     * Move to the next question
     */
    nextQuestion() {
        if (this.gameState !== 'question-answered') {
            throw new Error('Must answer current question first');
        }

        this.currentQuestionIndex++;
        return this.loadCurrentQuestion();
    }

    /**
     * Get current game statistics
     */
    getStats() {
        return {
            score: this.score,
            answered: this.answered,
            total: this.questions.length,
            percentage: this.answered > 0 ? Math.round((this.score / this.answered) * 100) : 0,
            remaining: this.questions.length - this.currentQuestionIndex,
            gameState: this.gameState
        };
    }

    /**
     * Get current question data
     */
    getCurrentQuestion() {
        return this.currentQuestion;
    }

    /**
     * Reset the game to initial state
     */
    reset() {
        this.currentQuestionIndex = 0;
        this.score = 0;
        this.answered = 0;
        this.gameState = this.questions.length > 0 ? 'ready' : 'loading';
        this.currentQuestion = null;
        this.userAnswer = null;
    }

    /**
     * Get game metadata
     */
    getMetadata() {
        return this.gameData?.metadata || {};
    }

    /**
     * Check if game is finished
     */
    isFinished() {
        return this.gameState === 'finished';
    }

    /**
     * Check if question has been answered
     */
    isQuestionAnswered() {
        return this.gameState === 'question-answered';
    }

    /**
     * Check if game is ready to play
     */
    isReady() {
        return this.gameState === 'ready';
    }

    /**
     * Check if currently playing
     */
    isPlaying() {
        return this.gameState === 'playing';
    }
}

/**
 * UI Controller for Just The Game
 * Handles all user interface interactions and updates
 */

class UIController {
    constructor(gameEngine) {
        this.game = gameEngine;
        this.elements = {};
        this.init();
    }

    /**
     * Initialize UI elements and event listeners
     */
    init() {
        // Cache DOM elements
        this.elements = {
            gameContainer: document.getElementById('game-container'),
            loadingScreen: document.getElementById('loading-screen'),
            startScreen: document.getElementById('start-screen'),
            gameScreen: document.getElementById('game-screen'),
            resultScreen: document.getElementById('result-screen'),
            finishScreen: document.getElementById('finish-screen'),
            gameTitle: document.getElementById('game-title'),
            gameDescription: document.getElementById('game-description'),
            questionCounter: document.getElementById('question-counter'),
            scoreDisplay: document.getElementById('score-display'),
            questionText: document.getElementById('question-text'),
            questionImage: document.getElementById('question-image'),
            choicesContainer: document.getElementById('choices-container'),
            resultIcon: document.getElementById('result-icon'),
            resultText: document.getElementById('result-text'),
            answerImage: document.getElementById('answer-image'),
            explanationText: document.getElementById('explanation-text'),
            nextButton: document.getElementById('next-button'),
            finalScore: document.getElementById('final-score'),
            finalPercentage: document.getElementById('final-percentage'),
            playAgainButton: document.getElementById('play-again-button'),
            questionSetTilesContainer: document.getElementById('question-set-tiles')
        };

        this.bindEvents();
    }

    /**
     * Bind event listeners
     */
    bindEvents() {
        if (this.elements.nextButton) {
            this.elements.nextButton.addEventListener('click', () => this.nextQuestion());
        }
        
        if (this.elements.playAgainButton) {
            this.elements.playAgainButton.addEventListener('click', () => this.restartGame());
        }
    }

    /**
     * Load game data and initialize
     */
    async loadGame() {
        this.showScreen('loading');
        
        try {
            const response = await fetch('./data/questions.json');
            const gameData = await response.json();
            
            const success = await this.game.loadQuestions(gameData);
            if (success) {
                this.updateStartScreen();
                this.showScreen('start');
            } else {
                this.showError('Failed to load game data');
            }
        } catch (error) {
            console.error('Error loading game:', error);
            this.showError('Failed to load game. Please check your connection.');
        }
    }

    /**
     * Load embedded game data (for packed version)
     */
    async loadEmbeddedGame() {
        this.showScreen('loading');
        
        try {
            // Use embedded data instead of fetching
            if (window.EMBEDDED_GAME_DATA) {
                const success = await this.game.loadQuestions(window.EMBEDDED_GAME_DATA);
                if (success) {
                    this.updateStartScreen();
                    this.showScreen('start');
                } else {
                    this.showError('Failed to load embedded game data');
                }
            } else {
                this.showError('No embedded game data found');
            }
        } catch (error) {
            console.error('Error loading embedded game:', error);
            this.showError('Failed to load embedded game data.');
        }
    }

    /**
     * Load embedded question sets (for packed version with multiple sets)
     */
    async loadEmbeddedQuestionSets() {
        this.showScreen('loading');
        
        try {
            if (window.EMBEDDED_QUESTION_SETS) {
                this.questionSets = window.EMBEDDED_QUESTION_SETS;
                
                // Load the first available question set by default
                const firstKey = Object.keys(this.questionSets)[0];
                if (firstKey) {
                    const success = await this.game.loadQuestions(this.questionSets[firstKey]);
                    if (success) {
                        this.currentQuestionSetKey = firstKey;
                        // Set the selector to the first key
                        if (this.elements.questionSetSelector) {
                            this.elements.questionSetSelector.value = firstKey;
                        }
                        this.updateStartScreenWithQuestionSets();
                        this.showScreen('start');
                    } else {
                        this.showError('Failed to load question set');
                    }
                } else {
                    this.showError('No question sets found');
                }
            } else {
                // Fallback to single embedded data for backwards compatibility
                this.loadEmbeddedGame();
            }
        } catch (error) {
            console.error('Error loading embedded question sets:', error);
            this.showError('Failed to load question sets.');
        }
    }

    /**
     * Handle question set selection change
     */
    async onQuestionSetChange(selectedKey) {
        if (this.questionSets && this.questionSets[selectedKey]) {
            const success = await this.game.loadQuestions(this.questionSets[selectedKey]);
            if (success) {
                this.currentQuestionSetKey = selectedKey;
                this.updateQuestionSetInfo();
            }
        }
    }

    /**
     * Update start screen with multiple question sets as tiles
     */
    updateStartScreenWithQuestionSets() {
        if (this.questionSets && this.elements.questionSetTilesContainer) {
            this.elements.questionSetTilesContainer.innerHTML = ''; // Clear existing tiles

            for (const key in this.questionSets) {
                if (Object.hasOwnProperty.call(this.questionSets, key)) {
                    const questionSet = this.questionSets[key];
                    const metadata = questionSet.metadata || {};

                    const tile = document.createElement('div');
                    tile.className = 'question-set-tile';
                    tile.dataset.key = key;

                    const title = document.createElement('h3');
                    title.className = 'tile-title';
                    title.textContent = metadata.title || key.replace(/_/g, ' ');

                    const description = document.createElement('p');
                    description.className = 'tile-description';
                    description.textContent = metadata.description || 'A set of questions on this topic.';

                    tile.appendChild(title);
                    tile.appendChild(description);

                    // Add hover events to show description below tiles
                    tile.addEventListener('mouseenter', () => {
                        if (this.elements.gameDescription) {
                            this.elements.gameDescription.textContent = metadata.description || 'A set of questions on this topic.';
                        }
                    });
                    
                    tile.addEventListener('mouseleave', () => {
                        if (this.elements.gameDescription) {
                            this.elements.gameDescription.textContent = 'Select a topic to begin.';
                        }
                    });

                    tile.addEventListener('click', () => this.startGame(key));

                    this.elements.questionSetTilesContainer.appendChild(tile);
                }
            }
        }
    }

    /**
     * Update start screen with game metadata
     */
    updateStartScreen() {
        // This function is now simplified as tiles handle most of the info.
        // We can set a generic title or description if needed.
        if (this.elements.gameTitle) {
            this.elements.gameTitle.textContent = "Just The Game";
        }
        if (this.elements.gameDescription) {
            this.elements.gameDescription.textContent = "Select a topic to begin your learning journey.";
        }
    }

    /**
     * Start the game with a specific question set
     * @param {string} questionSetKey - The key for the selected question set
     */
    async startGame(questionSetKey) {
        if (!questionSetKey || !this.questionSets[questionSetKey]) {
            this.showError('Please select a valid question set to start.');
            return;
        }
        
        this.currentQuestionSetKey = questionSetKey;
        const selectedSet = this.questionSets[this.currentQuestionSetKey];

        await this.game.loadQuestions(selectedSet);
        this.game.startGame();
        this.showQuestion();
        this.showScreen('game');
    }

    /**
     * Display current question
     */
    showQuestion() {
        const question = this.game.getCurrentQuestion();
        const stats = this.game.getStats();
        
        if (!question) {
            this.showFinishScreen();
            return;
        }

        // Update question counter and score
        if (this.elements.questionCounter) {
            this.elements.questionCounter.textContent = 
                `Question ${stats.answered + 1} of ${stats.total}`;
        }
        
        if (this.elements.scoreDisplay) {
            this.elements.scoreDisplay.textContent = 
                `Score: ${stats.score}/${stats.answered}`;
        }

        // Display question
        if (this.elements.questionText) {
            this.elements.questionText.textContent = question.question;
        }
        
        // Display question image if available
        if (this.elements.questionImage && question.image1) {
            this.elements.questionImage.src = question.image1;
            this.elements.questionImage.style.display = 'block';
        } else if (this.elements.questionImage) {
            this.elements.questionImage.style.display = 'none';
        }

        // Create choice buttons
        this.createChoiceButtons(question.choices);
    }

    /**
     * Create clickable choice buttons
     */
    createChoiceButtons(choices) {
        if (!this.elements.choicesContainer) return;

        this.elements.choicesContainer.innerHTML = '';
        
        choices.forEach((choice, index) => {
            const button = document.createElement('button');
            button.className = 'choice-button';
            button.textContent = choice;
            button.onclick = () => {
                console.log(`Choice ${index} clicked: ${choice}`);
                this.selectAnswer(index);
            };
            
            this.elements.choicesContainer.appendChild(button);
        });
        console.log(`Created ${choices.length} choice buttons`);
    }

    /**
     * Handle answer selection
     */
    selectAnswer(answerIndex) {
        console.log(`selectAnswer called with index: ${answerIndex}`);
        
        const result = this.game.submitAnswer(answerIndex);
        console.log('Answer submitted, result:', result);

        const buttons = this.elements.choicesContainer.querySelectorAll('.choice-button');
        const selectedButton = buttons[answerIndex];

        // Easy mode, incorrect answer: just mark it red and stop.
        if (result.mode === 'easy' && !result.correct) {
            selectedButton.classList.add('incorrect');
            selectedButton.disabled = true; // Prevent clicking the same wrong answer
            console.log('Easy mode, incorrect answer. Allowing another try.');
            return; // Stop here, don't show result screen
        }

        // Hard mode OR Correct answer in easy mode: proceed to result screen.
        
        // Disable all choice buttons
        buttons.forEach(button => button.disabled = true);
        
        // Highlight correct and incorrect answers
        buttons.forEach((button, index) => {
            if (index === result.correctAnswerIndex) {
                button.classList.add('correct');
            } else if (index === answerIndex && !result.correct) {
                // This case only happens in hard mode now
                button.classList.add('incorrect');
            }
        });

        // Show result after a brief delay
        setTimeout(() => {
            console.log('About to show result screen...');
            this.showResult(result);
        }, 800);
    }

    /**
     * Show answer result and explanation
     */
    showResult(result) {
        if (this.elements.resultIcon) {
            this.elements.resultIcon.textContent = result.correct ? '✅' : '❌';
        }
        
        if (this.elements.resultText) {
            this.elements.resultText.textContent = result.correct 
                ? 'Correct!' 
                : `Incorrect. The correct answer was: ${result.correctAnswerText}`;
        }
        
        if (this.elements.explanationText) {
            this.elements.explanationText.textContent = result.explanation;
        }
        
        // Display answer image if available
        const currentQuestion = this.game.getCurrentQuestion();
        if (this.elements.answerImage && currentQuestion && currentQuestion.image2) {
            this.elements.answerImage.src = currentQuestion.image2;
            this.elements.answerImage.style.display = 'block';
        } else if (this.elements.answerImage) {
            this.elements.answerImage.style.display = 'none';
        }

        console.log('Showing result screen...');
        this.showScreen('result');
    }

    /**
     * Move to next question
     */
    nextQuestion() {
        const nextQ = this.game.nextQuestion();
        
        if (nextQ) {
            this.showQuestion();
            this.showScreen('game');
        } else {
            this.showFinishScreen();
        }
    }

    /**
     * Show final results
     */
    showFinishScreen() {
        const stats = this.game.getStats();
        
        if (this.elements.finalScore) {
            this.elements.finalScore.textContent = `${stats.score} out of ${stats.total}`;
        }
        
        if (this.elements.finalPercentage) {
            this.elements.finalPercentage.textContent = `${stats.percentage}%`;
        }

        this.showScreen('finish');
    }

    /**
     * Restart the game by reloading the page.
     */
    restartGame() {
        console.log('🔄 [UI] Restarting game by reloading the page.');
        location.reload();
    }

    /**
     * Show specific screen
     */
    showScreen(screenName) {
        // Hide all screens
        Object.values(this.elements).forEach(element => {
            if (element && element.classList && element.classList.contains('screen')) {
                element.style.display = 'none';
            }
        });

        // Show requested screen
        const screenMap = {
            'loading': this.elements.loadingScreen,
            'start': this.elements.startScreen,
            'game': this.elements.gameScreen,
            'result': this.elements.resultScreen,
            'finish': this.elements.finishScreen
        };

        const targetScreen = screenMap[screenName];
        if (targetScreen) {
            targetScreen.style.display = 'block';
        }
    }

    /**
     * Show error message
     */
    showError(message) {
        // Simple error display - could be enhanced with a proper error screen
        if (this.elements.loadingScreen) {
            this.elements.loadingScreen.innerHTML = `
                <div class="error">
                    <h2>Error</h2>
                    <p>${message}</p>
                    <button onclick="location.reload()">Retry</button>
                </div>
            `;
        }
    }
}
    </script>
    
    <!-- Game Initialization -->
    <script>
        // Initialize the game when page loads
        document.addEventListener('DOMContentLoaded', function() {
            const gameEngine = new GameEngine();
            const uiController = new UIController(gameEngine);
            
            // Start loading the game with multiple question sets
            uiController.loadEmbeddedQuestionSets();
        });
    </script>
</body>
</html>